---
title: 数组对象
date: 2019-10-8 23:37:18
tags:
---
## Array 对象
上一篇我们说的是数组的基础知识，这一次我们来看看数组对象。
### 构造函数
`Array`是一个构造函数，可以用它生成新的数组。
```js
var arr = new Array(2);
arr.length // 2
arr // [ empty x 2 ] 生成两个空值
```
如果没有使用`new`关键字，运行结果也是一样的。
上面的参数是一个正整数，返回数组的成员都是空位。虽然读取的时候返回`undefined`，但实际上该位置没有任何值。虽然可以取到`length`属性，但是取不到键名。
```js
arr[0]  //undefined
arr[1]  //undefined
```

`Array`构造函数有一个很大的缺陷，就是不同的参数，会导致它的行为不一致。
```js
var a = new Array(3)  //[ empty x 3 ]

var b = new Array(2,3) //[2, 3]  
```
一个参数生成的是长度，一个以上的参数生成的则是数组成员，所以我们推荐直接使用数组字面量来声明是更好的做法。
```js
var a = [2, 3]
```
### 实例方法
**valueOf()，toString()**
`valueOf`方法是一个所有对象都拥有的方法，表示对该对象求值。不同对象的`valueOf`方法不尽一致，数组的`valueOf`方法返回数组本身。
```js
var arr = [1, 2, 3];
arr.valueOf() // [1, 2, 3]
```
`toString`方法也是对象的通用方法，数组的`toString`方法返回数组的字符串形式。
```js
var arr = [1, 2, 3];
arr.toString() // "1,2,3"

var arr = [1, 2, 3, [4, 5, 6]];
arr.toString() // "1,2,3,4,5,6"
```
**push()，pop()**
`push`方法用于在数组的末端添加一个或多个元素，并返回添加新元素后的数组长度。注意，该方法会改变原数组。
```js
var arr = [];

arr.push(1) // 1
arr.push('a') // 2
arr.push(true, {}) // 4
arr // [1, 'a', true, {}]
```
上面代码使用`push`方法，往数组中添加了四个成员。
`pop`方法用于删除数组的最后一个元素，并返回该元素。注意，该方法会改变原数组。
```js
var arr = ['a', 'b', 'c'];

arr.pop() // 'c'
arr // ['a', 'b']
```
对空数组使用`pop`方法，不会报错，而是返回`undefined`。
```js
[].pop() // undefined
```
`push`和`pop`结合使用，就构成了“先进后出”的栈结构（stack）。

**shift()，unshift()**

`shift()`方法用于删除数组的第一个元素，并返回该元素。注意，该方法会改变原数组。
```js
var a = ['a', 'b', 'c'];

a.shift() // 'a'
a // ['b', 'c']
```
上面代码中，使用`shift()`方法以后，原数组就变了。
`unshift()`方法用于在数组的第一个位置添加元素，并返回添加新元素后的数组长度。注意，该方法会改变原数组。
```js
var a = ['a', 'b', 'c'];

a.unshift('x'); // 4
a // ['x', 'a', 'b', 'c']
```
`unshift()`方法可以接受多个参数，这些参数都会添加到目标数组头部。
```js
var arr = [ 'c', 'd' ];
arr.unshift('a', 'b') // 4
arr // [ 'a', 'b', 'c', 'd' ]
```

`push()`和`shift()`结合使用，就构成了“先进先出”的队列结构（queue）。

**sort()**
sort方法对数组成员进行排序,排序后，原数组将被改变。
```js
['d', 'c', 'b', 'a'].sort()
// ['a', 'b', 'c', 'd']

[4, 3, 2, 1].sort()
// [1, 2, 3, 4]

[11, 101].sort()
// [101, 11]

[10111, 1101, 111].sort()
// [10111, 1101, 111]
```
上面代码的最后两个例子，需要特殊注意。`sort()`方法不是按照大小排序，而是按照字典顺序。
如果想让`sort`方法按照自定义方式排序，可以传入一个函数作为参数。
```js
[10111, 1101, 111].sort(function (a, b) {
  return a - b;
})
// [111, 1101, 10111]
```
**join()**
`join()`方法以指定参数作为分隔符，将所有数组成员连接为一个字符串返回。如果不提供参数，默认用逗号分隔。
```js
var a = ['a','b','c','d']

a.join(' ')   //"a b c d"
a.join(' | ') //"a | b | c | d"
```
通过`call`方法，这个方法也可以用于字符串或类似数组的对象。

**concat()**
`concat`方法用于多个数组的合并。它将新数组的成员，添加到原数组成员的后部，然后返回一个新数组，原数组不变。
```js
['hello'].concat(['world'])
// ["hello", "world"]

['hello'].concat(['world'], ['!'])
// ["hello", "world", "!"]

[].concat({a: 1}, {b: 2})
// [{ a: 1 }, { b: 2 }]

[2].concat({a: 1})
// [2, {a: 1}]
```
**map()**
`map`方法将数组的所有成员依次传入参数函数，然后把每一次的执行结果组成一个新数组返回。
```js
var numbers = [1, 2, 3];

numbers.map(function (n) {
  return n * 2;
});
// [2, 4, 6]

numbers
// [1, 2, 3]
```
`map`方法接受一个函数作为参数。该函数调用时，`map`方法向它传入三个参数：当前成员、当前位置和数组本身。
```js
[1, 2, 3].map(function(elem, index, arr) {  
  return elem * index;
});
// [0, 2, 6]
//elem为当前成员的值，index为当前成员的位置，arr为原数组（[1, 2, 3]）。
```
如果数组有空位，`map`方法的回调函数在这个位置不会执行，会跳过数组的空位。
**filter()**
`filter`方法用于过滤数组成员，返回结果为true的成员组成一个新数组返回。。该方法不会改变原数组。
```js
[3,5,6,7,9,15].filter(function(ele){
  return ele % 3 === 0
})
// [3, 6, 9, 15]
```
```js
var arr = [0, 1, 'a', false];

arr.filter(Boolean)
// [1, "a"]
```
上面代码中，`filter`方法返回数组arr里面所有布尔值为true的成员。
`filter`方法的参数函数可以接受三个参数：当前成员，当前位置和整个数组。
```js
[1, 2, 3, 4, 5].filter(function (elem, index, arr) {
  return index % 2 === 0;
});
// [1, 3, 5]
```
**reduce()**
`reduce`方法从左到右处理（从第一个成员到最后一个成员）依次处理数组的每个成员，最终累计为一个值。
```js
[1, 2, 3, 4, 5].reduce(function (a, b) {
  console.log(a, b);
  return a + b;
})
// 1 2
// 3 3
// 6 4
// 10 5
//最后结果：15
```
上面代码中，`reduce`方法求出数组所有成员的和。第一次执行，`a`是数组的第一个成员`1`，`b`是数组的第二个成员`2`。第二次执行，`a`为上一轮的返回值`3`，`b`为第三个成员`3`。第三次执行，`a`为上一轮的返回值`6`，`b`为第四个成员`4`。第四次执行，`a`为上一轮返回值`10`，`b`为第五个成员`5`。至此所有成员遍历完成，整个方法的返回值就是最后一轮的返回值`15`。

`reduce`方法的第一个参数都是一个函数。该函数接受以下四个参数。

  1. 累积变量，默认为数组的第一个成员
  2. 当前变量，默认为数组的第二个成员
  3. 当前位置（从0开始）
  4. 原数组

这四个参数之中，只有前两个是必须的，后两个则是可选的。

如果要对累积变量指定初值，可以把它放在`reduce`方法的第二个参数。
```js
[1, 2, 3, 4, 5].reduce(function (a, b) {
  return a + b;
}, 10);
// 25
```
上面代码指定参数`a`的初值为`10`，所以数组从`10`开始累加，最终结果为`25`。注意，这时b是从数组的第一个成员开始遍历。

由于这两个方法会遍历数组，所以实际上还可以用来做一些遍历相关的操作。比如，找出字符长度最长的数组成员。
```js
function findLongest(entries) {
  return entries.reduce(function (longest, entry) {
    return entry.length > longest.length ? entry : longest;
  }, '');
}

findLongest(['aaa', 'bb', 'c']) // "aaa"
```
